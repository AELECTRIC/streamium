require=function t(e,i,n){function s(o,u){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var p=i[o]={exports:{}};e[o][0].call(p.exports,function(t){var i=e[o][1][t];return s(i?i:t)},p,p.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){"use strict";function n(t){t=t||{},this.network=o.get(t.network||"livenet"),this.expires=t.expires||Math.round((new Date).getTime()/1e3)+l,this.commitmentKey=new u(t.commitmentKey),this.providerPublicKey=new c(t.providerPublicKey),this.providerAddress=t.providerAddress?new a(t.providerAddress):this.providerPublicKey.toAddress(),this.fundingKey=t.fundingKey||new u,this.fundingAddress=this.fundingKey.toAddress(),t.refundAddress?this.refundAddress=t.refundAddress instanceof a?t.refundAddress:new a(t.refundAddress):(this.refundKey=new u,this.refundAddress=new a(this.refundKey.publicKey,this.network)),this.commitmentTx=new d({publicKeys:[this.commitmentKey.publicKey,this.providerPublicKey],network:this.network})}var s=t("bitcore").util.preconditions,r=t("bitcore").Script,o=t("bitcore").Networks,u=t("bitcore").PrivateKey,c=t("bitcore").PublicKey,a=t("bitcore").Address,p=t("bitcore").deps._,d=t("./transactions/commitment"),h=t("./transactions/payment"),m=t("./transactions/refund"),y=24,f=60,b=60,l=b*f*y;n.prototype.processFunding=function(t){s.checkArgument(p.isObject(t),"Can only process an array of objects or an object"),this.commitmentTx.from(t)},n.prototype.setupRefund=function(){this.commitmentTx.sign(this.fundingKey),s.checkState(this.commitmentTx.isFullySigned());var t=this.commitmentTx.amount-this.commitmentTx.getFee(),e={txid:this.commitmentTx.id,outputIndex:0,satoshis:t,script:this.commitmentTx.outputs[0].script};return this.refundTx=(new m).from(e,this.commitmentTx.publicKeys,2),this.refundTx.to(this.refundAddress,this.refundTx.inputAmount),this.refundTx.inputs[0].sequenceNumber=0,this.refundTx.nLockTime=this.expires,this.refundTx},n.prototype.validateRefund=function(t){t=new m(t),t.sign(this.commitmentKey);var e=new a(t.outputs[0].script,this.network).toString();s.checkState(e===this.refundAddress.toString());var i=t.outputs[0].satoshis;s.checkState(i===this.commitmentTx.amount-this.commitmentTx.getFee(),"Refund amount must equal commitmentTx amount"),s.checkState(1===t.outputs.length,"More than expected outputs received"),s.checkState(t.isFullySigned(),"Refund was not fully signed"),s.checkState(r.Interpreter().verify(t.inputs[0].script,t.inputs[0].output.script),"Refund is incorrectly signed"),this.refundTx=t;var n={txid:this.commitmentTx.hash,outputIndex:0,satoshis:i,script:this.commitmentTx.outputs[0].script};return this.paymentTx=new h({multisigOut:n,amount:i,paymentAddress:this.providerAddress,changeAddress:this.refundAddress,publicKeys:this.commitmentTx.publicKeys,network:this.network}),this.paymentTx.sign(this.commitmentKey),!0},n.prototype.incrementPaymentBy=function(t){return this.paymentTx.updateValue(t),this.paymentTx.sign(this.commitmentKey),this.paymentTx.toObject()},n.prototype.getPaymentTx=function(){return this.paymentTx},e.exports=n},{"./transactions/commitment":4,"./transactions/payment":5,"./transactions/refund":6,bitcore:"bitcore"}],2:[function(t,e,i){"use strict";var n={name:"Channel",message:"Internal Error on bitcore-channels Module {0}"};e.exports=t("bitcore").errors.extend(n)},{bitcore:"bitcore"}],3:[function(t,e,i){"use strict";function n(t){this.network=p.get(t.network)||p.defaultNetwork,t.paymentAddress?this.paymentAddress=new a(t.paymentAddress):(this.paymentKey=new u,this.paymentAddress=this.paymentKey.toAddress(this.network)),this.currentAmount=t.currentAmount||0,this.key=t.key||new u}var s=t("./transactions/payment"),r=t("./transactions/refund"),o=t("bitcore").util.preconditions,u=t("bitcore").PrivateKey,c=t("bitcore").Script,a=t("bitcore").Address,p=t("bitcore").Networks,d=t("bitcore").deps._;n.prototype.getPublicKey=function(){return this.key.publicKey},n.prototype.signRefund=function(t){var e=new r(t);return e.sign(this.key),this.refund=e,e},n.prototype.validPayment=function(t){var e,i=new s(t),n=this;return i.sign(this.key),i.outputs.map(function(t){t.script.toAddress(n.network).toString()===n.paymentAddress.toString()&&(e=t.satoshis)}),o.checkState(!d.isUndefined(e),"No output found corresponding to paymentAddress"),o.checkState(c.Interpreter().verify(i.inputs[0].script,i.inputs[0].output.script),"Script did not evaluate correctly (probably a bad signature received)"),o.checkState(e>this.currentAmount,"A payment for a greater amount was already received"),this.paymentTx=i,this.currentAmount=e,i},n.prototype.getPaymentTx=function(){return this.paymentTx.build()},e.exports=n},{"./transactions/payment":5,"./transactions/refund":6,bitcore:"bitcore"}],4:[function(t,e,i){"use strict";function n(t){r.checkArgument(t.publicKeys&&2===t.publicKeys.length,"Must provide exactly two public keys"),u.call(this,t.transaction),this.network=t.network||"livenet",this.publicKeys=t.publicKeys,this.outscript=o.buildMultisigOut(this.publicKeys,2),this.address=this.outscript.toScriptHashOut().toAddress(),this.outputs.length||(this.change(this.address),this._updateChangeOutput()),Object.defineProperty(this,"amount",{configurable:!1,get:function(){return this.inputAmount}})}var s=t("inherits"),r=t("bitcore").util.preconditions,o=t("bitcore").Script,u=t("bitcore").Transaction,c=t("bitcore").deps._;s(n,u),n.prototype.toObject=function(){var t=u.prototype.toObject.apply(this);return{transaction:t,publicKeys:c.map(this.publicKeys,function(t){return t.toString()}),network:this.network.toString()}},n.prototype.getAddress=function(){return this.address},e.exports=n},{bitcore:"bitcore",inherits:7}],5:[function(t,e,i){"use strict";function n(t){return this instanceof n?(o.call(this,t.transaction),this.paymentAddress=new r(t.paymentAddress),this.changeAddress=new r(t.changeAddress),this.outputs.length||(this.change(this.changeAddress),this._updateChangeOutput()),this.multisigOut=new o.UnspentOutput(t.multisigOut),this.publicKeys=a.map(t.publicKeys,u),this.inputs.length||this.from(this.multisigOut,this.publicKeys,2),this.amount=this.outputAmount,this.sequence=t.sequence||0,this.paid=t.paid||0,void c.checkArgument(a.isNumber(this.amount),"Amount must be a number")):new n(t)}var s=t("inherits"),r=t("bitcore").Address,o=t("bitcore").Transaction,u=t("bitcore").Publickey,c=t("bitcore").util.preconditions,a=t("bitcore").deps._;s(n,o),n.prototype._updateTransaction=function(){this.clearOutputs(),this.to(this.paymentAddress,this.paid),this.inputs[0].sequence=this.sequence},n.prototype.updateValue=function(t){return this.paid+=t,this.sequence+=1,this._updateTransaction(),this},n.prototype.toObject=function(){return{publicKeys:a.map(this.publicKeys,function(t){return t.toString()}),multisigOut:this.multisigOut.toObject(),amount:this.amount,sequence:this.sequence,paymentAddress:this.paymentAddress.toString(),changeAddress:this.changeAddress.toString(),transaction:o.prototype.toObject.apply(this)}},n.fromObject=function(t){return new n(t)},e.exports=n},{bitcore:"bitcore",inherits:7}],6:[function(t,e,i){"use strict";function n(){r.apply(this,arguments)}var s=t("inherits"),r=t("bitcore").Transaction;s(n,r),e.exports=n},{bitcore:"bitcore",inherits:7}],7:[function(t,e,i){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],"bitcore-channel":[function(t,e,i){t("./lib/errors"),e.exports={Consumer:t("./lib/consumer"),Provider:t("./lib/provider"),Transactions:{Commitment:t("./lib/transactions/commitment"),Refund:t("./lib/transactions/refund"),Payment:t("./lib/transactions/payment")}}},{"./lib/consumer":1,"./lib/errors":2,"./lib/provider":3,"./lib/transactions/commitment":4,"./lib/transactions/payment":5,"./lib/transactions/refund":6}]},{},[]);